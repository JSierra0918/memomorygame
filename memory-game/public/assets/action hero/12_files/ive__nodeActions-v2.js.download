!function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./",i(i.s=1044)}({1044:function(e,t,i){i(288),i(289),i(290),i(291),i(292),i(293),i(294),i(295),i(296),i(297),i(298),i(299),i(300),i(301),i(302),i(303),i(304),i(305),i(306),e.exports=i(307)},288:function(e,t,i){},289:function(e,t,i){},290:function(e,t,i){},291:function(e,t,i){},292:function(e,t,i){},293:function(e,t,i){},294:function(e,t,i){},295:function(e,t){var i,a,n;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,i.nodeDelete=function(e,t){t=t||!1;var a=e.getAttribute("data-ive-options");(a=a&&""!==a?a.parseQueryString():{}).deleteType=(a.deleteType||"EDIT").toUpperCase();var o,s,r=document.querySelector('#list [data-node-id="'.concat(a.nodeId,'"]'));return!!r&&!(!0!==t&&!window.confirm("Are you sure you want to delete this item? \nClick the cancel button if you change your mind."))&&(function(e){n(function(){e.remove()})}(r),function(){var e=document.getElementsByClassName("list__dataItem--totalItems")[0];e&&(e.textContent="".concat(RList.listStats.totalItems," items"))}(),(s=document.getElementsByClassName("ive__create")[0])&&(o=s.getElementsByClassName("listItem__rank")[0]),o&&n(function(){o.textContent=RList.listStats.totalItems+1}),function(){var e=document.getElementById("ive__barNodeCount");e&&(e.textContent=RList.listStats.totalItems)}(),RView.IVE.menuDestroy(),RView.trivia&&RView.trivia.closeAll(),RUtils.trackEvent({category:"list",action:"".concat(a.deleteType,"_delete")}),function(e){return new Promise(function(t){RUtils.ajax({method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(e.listId,"/items/").concat(e.nodeId),callback:function(){--RList.listStats.totalItems,i.flushListCache(e),t(!0)}})})}(a))},i)},296:function(e,t){var i,a,n,o,s,r;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=null,s=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t},r=function(e){n(function(){o=e.textContent,e.setAttribute("ContentEditable",!0),e.setAttribute("data-ive-keyup","node:nameEdit:save"),e.setAttribute("data-ive-blur","node:nameEdit:update"),e.setAttribute("data-ive-prevententer",!0),e.classList.add("ive__nodeNameEdit"),e.focus(),i.bindEvents()})},i.nodeNameEdit=function(e){var t=s(e),i=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__title")[0];r(i),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeNameEdit")})},i.nodeNameClick=function(e){var t=s(e);r(e),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeNameEdit")})},i.nodeNameSave=function(e){if(0===e.textContent.trim().length)return e.textContent=o,e.focus(),void alert("Item Names cannot be blank. Please try again.");var t=s(e);RUtils.ajax({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/nodeedits/").concat(t.listId,"/nodes/").concat(t.nodeId,"/edit"),data:JSON.stringify({listId:t.listId,ontologyId:t.nodeId,value:e.textContent,valueId:t.nodeId,classId:RList.classId,classPropertyId:"-2",editDate:Date.now(),createdDate:Date.now(),editType:"ADD_NODE"}),error:function(e){RUtils.console.error("IVE","Item saving error",e),alert("There was an error saving your change. Please try again.")},callback:function(){i.flushListCache(t)}})},i.nodeNameUpdate=function(e){s(e),function(e){n(function(){e.setAttribute("ContentEditable",!1),e.classList.remove("ive__nodeNameEdit"),i.bindEvents()})}(e),i.nodeNameSave(e)},i)},297:function(e,t){var i,a,n,o,s;RView.IVE=(i=RView.IVE,a=new RegExp(/^(http:|https:)(\/{2})[\w].*$/),n=[{id:"BUY",name:"Buy"},{id:"WATCH",name:"Watch"},{id:"EBAY",name:"Ebay"},{id:"AMAZON",name:"Amazon"},{id:"AMAZON_WATCH",name:"Amazon Watch"},{id:"SPOTIFY",name:"Spotify"},{id:"ITUNES",name:"iTunes"},{id:"SEE_HOTELS",name:"See Hotels"},{id:"SEE_DEALS",name:"See Deals"},{id:"READ_REVIEWS",name:"Read Reviews"},{id:"CAMPUS_EXPLORER",name:"Campus Explorer"},{id:"CAR_HUB",name:"Car Hub"},{id:"FUBOTV",name:"FuboTV"}],o=function(e,t){var i=document.createDocumentFragment(),a=document.createElement("input");a.id="ive__nodeLinkInput",a.className="ive__formInput relative inlineBlock",a.placeholder="add external link",a.setAttribute("data-ive-options",t),e&&e.link&&(a.value=e.link);var o=document.createElement("select");o.id="ive__nodeLinkType",o.className="ive__formInput relative inlineBlock",e.linkType||(e.linkType="");for(var s,r=0;s=n[r];r++){var c=document.createElement("option");c.value=s.id,c.textContent=s.name,(s.id===e.linkType.name||"BUY"===s.id&&"GENERIC"===e.linkType.name||"WATCH"===s.id&&"YIDEO"===e.linkType.name)&&(c.selected=!0),o.appendChild(c)}i.appendChild(a),i.appendChild(o),function(e){var t=document.getElementById("modal__iveNodeLink").getElementsByClassName("modal__content")[0];RUtils.spinner.destroy("modalLoad"),requestAnimationFrame(function(){t.appendChild(e)})}(i)},s=function(e){var t=document.getElementById("ive__nodeLinkInput").value.trim(),n=document.getElementById("ive__nodeLinkType").value;""!==t?a.test(t)?(RUtils.ajax({method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(e.listId,"/items/").concat(e.nodeId,"/link"),data:JSON.stringify({link:t,linkType:{name:n},userEdited:!0}),callback:function(t){!function(e,t){var a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__buyButton")[0];if(a){a.href=e.link;var n=a.getElementsByClassName("listItem__buyButtonImg")[0];n&&(n.src="".concat(RConstants.staticPath,"/dist/img/app/buyButton/").concat(e.linkType.toLowerCase(),"_buy.png"))}else{var o=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]'));o&&o.appendChild(i.buildBuyButton(t.listId,{type:e.linkType,url:RView.list.getListItemLink(e,"button"),node:{id:t.nodeId}}))}}(t,e)}}),RUtils.modal.destroy("iveNodeLink")):alert("External links must start with http:// or https://"):function(e){RUtils.ajax({method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(e.listId,"/items/").concat(e.nodeId,"/link"),error:function(e){RUtils.console.error("IVE: external link",e)}}),RUtils.modal.destroy("iveNodeLink")}(e)},i.nodeLinkEdit=function(e){var t=function(e){var t=e.getAttribute("data-ive-options");return t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}}(e);RUtils.modal.create({id:"iveNodeLink",width:"610px",height:"210px",title:"add/edit external URL",closeOnClick:!1,closeOnEscape:!0,closeOnSuccess:!1,showSpinner:!0,successButton:"done",onOpen:function(){!function(e){RUtils.ajax({method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(e.listId,"/items/").concat(e.nodeId,"/link"),error:function(t){RUtils.console.error("IVE: external link",t),o({},e)},callback:function(t){o(t,e)}})}(t)},onSuccess:function(){s(t)}}),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeLinkEdit")})},i)},298:function(e,t){var i,a,n,o,s,r,c;RView.IVE=(i=RView.IVE,a=window.setTimeout,window.clearTimeout,n=window.requestAnimationFrame||a,o=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t},s=function(e,t,i){var a=document.getElementById("ive__imageEditPreviewImg"),o=document.getElementById("ive__imageEditAttribution"),s=R[i.listId].listViewFormatType,r="";switch(s){case"BLOG":if(r+='<img src="'.concat(e.imgixUrl?e.imgixUrl:e.original.image,'?w=650&q=50&fit=crop&crop=faces&fm=pjpg" class="listItem__image" alt="">').concat(RUtils.imageAttribution.getAttribution(e.attribution,null,{format:"STRING"})),R[i.listId].listOptions.voteRanked){var c=t.parentNode.getElementsByClassName("voteBottom__image")[0];n(function(){c.src="".concat(e.imgixUrl?e.imgixUrl:e.original.image,"?w=120&h=120&q=50&fm=pjpg&fit=crop&crop=faces")})}n(function(){t.classList.remove("listItem__figure--add"),t.classList.remove("listItem__figure--video")});break;case"GRID":r='<img src="'.concat(e.imgixUrl?e.imgixUrl:e.original.image,'?w=87&h=87&q=60&fm=pjpg&fit=crop&crop=faces" class="listItem__image" alt="">')}n(function(){a.setAttribute("src","".concat(e.imgixUrl?e.imgixUrl:e.original.image,"?w=303&h=303&q=60&fm=pjpg&fit=clip")),t.innerHTML=r,o&&(o.classList.remove("ive__imageEditAttribution--hide"),o.setAttribute("data-ive-options","".concat(i.parseObjectAsQueryString(),"&imageNumber=").concat(e.imageNumber)))})},r=function(e,t,o){var s="".concat(RConstants.staticPath,"/dist/img/app/ranker_noimage--small.svg");o.image&&o.image.imgixUrl&&(s=o.image.imgixUrl);var r,c,d=t.parseObjectAsQueryString(),l="".concat('<div id="ive__imageEditHead"><figure id="ive__imageEditPreview" class="float flex"><img id="ive__imageEditPreviewImg" class="block" src=" ').concat(s,'?w=303&h=303&q=60&fm=pjpg&fit=clip" />')+"</figure>";i.isAdmin()&&(l+='<span id="ive__imageEditAttribution" class="'.concat(o.image&&o.image.imgixUrl?"":"ive__imageEditAttribution--hide ",'float center rnkrBlue pointer $ive" ')+'data-ive-click ="node:imageEdit:attributionEdit" '+'data-ive-options="'.concat(d,"&imageType=node&imageNumber=").concat(o.image?o.image.imageNumber:"",'">add/edit attribution</span>')),l+="".concat('<h3 id="ive__imageEditHeadH3" class="block robotoC">add image</h3><h2 id="ive__imageEditHeadH2" class="block robotoL">').concat(o.name?o.name:o.node.name,"</h2>"),(RList.listOptions.allowUserImages||i.isAdmin())&&(l+="".concat('<label id="ive__imageEditFile" class="button button--rounded button--blue button__default inlineBlock relative center" for="ive__imageEditFileInput"><svg class="ive__imageEditFileIcon relative inlineBlock"><use xlink:href="#rsvg__arrows--voteUp" href="#rsvg__arrows--voteUp" /></svg> upload your own image</label><input type="file" name="imageFile" id="ive__imageEditFileInput" class="relative $ive" size="16" data-ive-change="node:imageEdit:previewFile" data-ive-options="').concat(d,'&imageType=node&uploadType=file"/>')+'<input type="text" name="imageURL" id="ive__imageEditURLInput" class="ive__formInput relative inlineBlock $ive" placeholder="or, type in an image URL" data-ive-paste="node:imageEdit:previewURL" '+'data-ive-options="'.concat(d,'&imageType=node&uploadType=url"/>')+'<label id="ive__imageEditURL" class="button button--rounded button--blue button__default inlineBlock relative center $ive" for="ive__imageEditURLInput" data-ive-click="node:imageEdit:previewURL" '+'data-ive-options="'.concat(d,'&imageType=node&uploadType=url">')+'<svg class="ive__imageEditURLIcon relative inlineBlock"><use xlink:href="#rsvg__arrows--chevronUp" href="#rsvg__arrows--chevronUp"/></svg></label>'),l+="</div>",l+="".concat('<div id="ive__imageEditGallery"><input type="text" name="imageGallerySearch" id="ive__imageEditGallerySearchInput" class="ive__formInput relative inlineBlock $ive" value="').concat(o.name?o.name:o.node.name,'" ')+'data-ive-paste="node:imageEdit:gallerySearch" data-ive-keyup="node:imageEdit:gallerySearchByKey" '+'data-ive-options="'.concat(d,'&imageType=node&uploadType=url"/>')+'<label id="ive__imageEditGallerySearch" class="button button--rounded button--blue button__default inlineBlock relative center $ive" for="ive__imageEditGallerySearchInput" data-ive-click="node:imageEdit:gallerySearch" '+'data-ive-options="'.concat(d,'&imageType=node&uploadType=url&forcePage1=true">')+'<svg class="ive__imageEditGallerySearchIcon relative inlineBlock"><use xlink:href="#rsvg__ui--search" href="#rsvg__ui--search"/></svg></label><div id="ive__imageEditGalleryTabs" class="relative"><span class="ive__imageEditGalleryTab ive__imageEditGalleryTab--flickr ive__imageEditGalleryTab--selected float relative inlineBlock whiteBg pointer $ive" data-ive-click="node:imageEdit:galleryTab" '+'data-ive-options="'.concat(d,'&imageType=node&uploadType=url&galleryType=flickr">')+"Popular</span>",t.nodeId<1e9&&(l+="".concat('<span class="ive__imageEditGalleryTab ive__imageEditGalleryTab--ranker float relative inlineBlock whiteBg pointer $ive" data-ive-click="node:imageEdit:galleryTab" data-ive-options="').concat(d,'&imageType=node&uploadType=url&galleryType=ranker">')+"Photo Gallery</span>"),r=l+='</div><div id="ive__imageEditGalleryResults" class="flex"></div></div>',c=document.getElementById("modal__imageEdit").getElementsByClassName("modal__content")[0],n(function(){c.innerHTML=r,a(function(){n(function(){document.getElementById("ive__imageEditGallerySearch").click()})},1500)})},c=function(e,t){if(!t.nodeId)return RUtils.console.warn("IVE","No node ID found, skipping."),!1;RUtils.ajax({url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId),callback:function(i){!function(i){e,t,i,r(0,t,i)}(i)}})},i.nodeImageEdit=function(e){var t=o(e);RUtils.modal.create({id:"imageEdit",width:"808px",height:"750px",hideTitle:!0,successButton:"done",closeOnClick:!1,closeOnEscape:!0,closeOnSuccess:!0,showSpinner:!0,onOpen:function(){c(e,t)}}),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeImageEdit")})},i.nodeImagePreviewFromFile=function(e){var t=o(e);i.imagePreview(e.files[0],t),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeImagePreviewFromFile")})},i.nodeImagePreviewFromURL=function(e){if("INPUT"!==e.tagName&&(e=document.getElementById("".concat(e.getAttribute("id"),"Input"))),""!==e.value.trim()){var t=o(e);i.imagePreview(e.value,t),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeImagePreviewFromURL")})}},i.nodeImageAdd=function(e,t){document.getElementById("ive__previewImage").innerHTML=RUtils.spinner.create("ive__previewImage");var a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__figure")[0],n="".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/images"),o={sourceUrl:e.cropped.image,attribution:e.attribution};t.imageSource&&""!==t.imageSource&&(o.imageSource=t.imageSource),RUtils.ajax({method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:n,data:JSON.stringify(o),error:function(e){RUtils.console.error("IVE","Image saving error",e),alert("There was an error saving your image. Please try again."),i.imagePreviewDestroy()},callback:function(e){i.imagePreviewDestroy(),s(e,a,t),i.flushListCache(t)}}),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeImageAdd")})},i.nodeImageUseRanker=function(e,t){document.getElementById("ive__previewImage").innerHTML=RUtils.spinner.create("ive__previewImage");var a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__figure")[0],n="".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/images/").concat(e.imageNumber,"/default");RUtils.ajax({method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:n,error:function(e){RUtils.console.error("IVE","Image saving error",e),alert("There was an error saving your image. Please try again."),i.imagePreviewDestroy()},callback:function(){i.imagePreviewDestroy(),s(e,a,t),i.flushListCache(t)}}),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeImageUseRanker")})},i.nodeImageDelete=function(e){var t=o(e),a="".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/images");RUtils.ajax({method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:a,error:function(e){RUtils.console.error("IVE","Image saving error",e)},callback:function(){RView.IVE.menuDestroy(),i.flushListCache(t)}})},i)},299:function(e,t){var i,a,n,o;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=function(e){RUtils.ajax({method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(e.listId,"/items/").concat(e.nodeId,"/options"),data:JSON.stringify({showImage:!e.showImage.parseBoolean()}),error:function(){RUtils.console.warn("IVE","error on node show image, skipping.")},callback:function(){!function(e){var t="listId=".concat(e.listId,"&nodeId=").concat(e.nodeId,"&showImage="),i="node:blatherEdit:title|node:blatherEdit:action,node:blatherDelete:title|node:blatherDelete:action",a=document.querySelector('.listItem[data-node-id="'.concat(e.nodeId,'"]')),o=a.getElementsByClassName("listItem__blather")[0];a&&o&&n(function(){e.showImage.parseBoolean()?(i+=",node:showImage:title|node:showImage:action",t+="false",o.setAttribute("data-ive-menu",i),o.setAttribute("data-ive-options",t),a.classList.add("listItem--blog--noImage")):(i+=",node:showImage:altTitle|node:showImage:action",t+="true",o.setAttribute("data-ive-menu",i),o.setAttribute("data-ive-options",t),a.classList.remove("listItem--blog--noImage"))})}(e)}})},i.nodeShowImage=function(e){if(e){var t=function(e){return(e.getAttribute("data-ive-options")||"").parseQueryString()}(e);t.listId&&t.nodeId&&t.showImage&&(o(t),RUtils.trackEvent({category:"list",action:"edit_nodeShowImage"}))}},i)},300:function(e,t){var i,a,n,o,s,r,c;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t},s=function(e,t,i){var a=document.getElementById("ive__videoEditPreview"),o=document.getElementById("ive__videoEditPreviewImg");n(function(){a.setAttribute("data-vpi-videoid",e.sourceId),a.setAttribute("data-vpi-videotype",e.videoType),a.setAttribute("data-vpi-videothumb",e.thumbUrl),o.setAttribute("src",e.thumbUrl),t.innerHTML="",t.classList.add("listItem__figure--video");var n=document.createElement("div");n.className="videoPlayer relative $vpi",n.setAttribute("data-vpi-videoid",e.sourceId),n.setAttribute("data-vpi-videotype",e.videoType),n.setAttribute("data-vpi-videoplacement","NODE"),n.setAttribute("data-vpi-videothumb",e.thumbUrl),"GRID"===R[i.listId].listViewFormatType&&(n.setAttribute("data-vpi-videowidth","540px"),n.setAttribute("data-vpi-videoheight","304px"),n.setAttribute("data-vpi-modal","true"));var s=document.createElement("img");s.className="videoPlayer__image listItem__image",s.src=e.thumbUrl,s.alt="Ranker Video",n.appendChild(s);var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"class","rsvg listItem__videoIcon videoPlayer__icon absolute play instapaper_ignore");var c=document.createElementNS("http://www.w3.org/2000/svg","use");c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#rsvg__ui--play"),c.setAttributeNS(null,"href","#rsvg__ui--play"),r.appendChild(c),n.appendChild(r),t.appendChild(n),"BLOG"===R[i.listId].listViewFormatType&&(t.classList.contains("listItem__figure--add")&&(t.classList.remove("listItem__figure--add"),t.classList.add("listItem__figure--video")),e.videoType&&t.appendChild(RUtils.videoAttribution.getAttribution(e)))})},r=function(e,t,i){var o="",s="",r="".concat(RConstants.staticPath,"/dist/img/app/blank.png"),c="";i.video&&(o=i.video.sourceId,s=i.video.videoType,r=i.video.thumbUrl,c="$vpi");var d,l,u=t.parseObjectAsQueryString(),m="".concat('<div id="ive__videoEditHead"><h3 id="ive__videoEditHeadH3" class="block center robotoC">add video</h3><h2 id="ive__videoEditHeadH2" class="block center robotoL">').concat(i.name?i.name:i.node.name,"</h2>")+'<figure id="ive__videoEditPreview" class="relative flex videoPlayer '.concat(c,'" ')+'data-vpi-videoid="'.concat(o,'" ')+'data-vpi-videotype="'.concat(s,'" ')+'data-vpi-videothumb="'.concat(r,'" ')+">"+'<img id="ive__videoEditPreviewImg" class="block" src=" '.concat(r,'" />')+'<svg class="rsvg ive__videoEditPreviewIcon absolute"><use xlink:href="#rsvg__ui--play" href="#rsvg__ui--play"/></svg></figure></div>';m+="".concat('<div id="ive__videoEditGallery"><input type="text" name="videoGallerySearch" id="ive__videoEditGallerySearchInput" class="ive__formInput relative inlineBlock $ive" value="').concat(i.name?i.name:i.node.name,'" ')+'data-ive-paste="node:videoEdit:gallerySearch" data-ive-keyup="node:videoEdit:gallerySearchByKey" '+'data-ive-options="'.concat(u,'&imageType=node&uploadType=url"/>')+'<label id="ive__videoEditGallerySearch" class="button button--rounded button--blue button__default inlineBlock relative center $ive" for="ive__videoEditGallerySearchInput" data-ive-click="node:videoEdit:gallerySearch" '+'data-ive-options="'.concat(u,'&imageType=node&uploadType=gallery&forcePage1=true">')+'<svg class="ive__videoEditGallerySearchIcon relative inlineBlock"><use xlink:href="#rsvg__ui--search" href="#rsvg__ui--search"/></svg></label><div id="ive__videoEditGalleryTabs" class="relative"><span class="ive__videoEditGalleryTab ive__videoEditGalleryTab--youtube ive__videoEditGalleryTab--selected float relative inlineBlock whiteBg pointer $ive" data-ive-click="node:videoEdit:galleryTab" '+'data-ive-options="'.concat(u,'&imageType=node&uploadType=url&galleryType=youtube">')+"Popular</span>",t.nodeId<1e9&&(m+="".concat('<span class="ive__videoEditGalleryTab ive__videoEditGalleryTab--ranker float relative inlineBlock whiteBg pointer $ive" data-ive-click="node:videoEdit:galleryTab" data-ive-options="').concat(u,'&imageType=node&uploadType=url&galleryType=ranker">')+"Recently Used</span>"),d=m+='</div><div id="ive__videoEditGalleryResults" class="flex"></div></div>',l=document.getElementById("modal__videoEdit").getElementsByClassName("modal__content")[0],n(function(){l.innerHTML=d,a(function(){n(function(){document.getElementById("ive__videoEditGallerySearch").click()})},1500)})},c=function(e,t){if(!t.nodeId)return RUtils.console.warn("IVE","No node ID found, skipping."),!1;RUtils.ajax({url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId),callback:function(i){!function(i){e,t,i,r(0,t,i)}(i)}})},i.nodeVideoEdit=function(e){var t=o(e);RUtils.modal.create({id:"videoEdit",width:"808px",height:"820px",hideTitle:!0,successButton:"done",closeOnClick:!1,closeOnEscape:!0,closeOnSuccess:!0,showSpinner:!0}),c(e,t),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeVideoEdit")})},i.nodeVideoAdd=function(e,t){document.getElementById("ive__previewVideo").innerHTML=RUtils.spinner.create("ive__previewVideo");var a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__figure")[0],n={embedUrl:e.url,sourceId:e.id,thumbUrl:e.thumbnail,videoType:t.source,userId:RUser.profile.getProperty("id")};RUtils.ajax({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/nodes/").concat(t.nodeId,"/videos"),data:JSON.stringify(n),error:function(e){RUtils.console.error("IVE","Video saving error",e),alert("There was an error saving your image. Please try again."),i.imagePreviewDestroy()},callback:function(e){var n=e;RUtils.ajax({method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/video"),data:JSON.stringify({value:e.videoId}),error:function(e){RUtils.console.error("IVE","Video saving error",e),alert("There was an error saving your image. Please try again."),i.imagePreviewDestroy()},callback:function(){i.videoPreviewDestroy(),s(n,a,t)}})}}),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeVideoAdd")})},i.nodeVideoUseRanker=function(e,t){document.getElementById("ive__previewVideo").innerHTML=RUtils.spinner.create("ive__previewVideo");var a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__figure")[0];RUtils.ajax({method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/video"),data:JSON.stringify({value:e.id}),error:function(e){RUtils.console.error("IVE","Video saving error",e),alert("There was an error saving your image. Please try again."),i.imagePreviewDestroy()},callback:function(n){i.videoPreviewDestroy(),e.thumbUrl=e.thumbnail,s(e,a,t)}}),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeVideoUseRanker")})},i.nodeVideoDelete=function(e){var t=o(e);RUtils.ajax({method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/video"),error:function(e){RUtils.console.error("IVE","Image saving error",e)},callback:function(){RView.IVE.menuDestroy(),i.flushListCache(t)}})},i)},301:function(e,t){var i,a,n;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,i.nodeMediaDelete=function(e){var t=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t}(e),a=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__figure")[0],o=R[t.listId].listViewFormatType;if(a.getElementsByClassName("listItem__image")[0].getAttribute("src").match(/ranker_noimage/gi))window.alert("You haven't added any media yet dufus...");else if(window.confirm("Are you sure you want to delete this media?")){switch(i.nodeImageDelete(e),i.nodeVideoDelete(e),n(function(){a.innerHTML=""}),o){case"BLOG":n(function(){a.classList.add("listItem__figure--add","relative"),a.appendChild(i.blogEmptyImage(t))});break;case"GRID":switch(t.editType){case"OPEN":n(function(){a.appendChild(RView.gridEmptyImage())});break;case"EDIT":n(function(){a.appendChild(i.gridEmptyImage())})}}RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeMediaDelete")})}},i)},302:function(e,t){var i,a,n,o,s,r,c,d,l;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=null,s=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t},r=function(e,t){RUtils.ajax({method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId,"/blather"),data:JSON.stringify({value:e}),callback:function(){i.flushListCache(t)}})},c=function(e,t,s){n(function(){e.innerHTML=s,e.removeAttribute("data-ive-click"),e.removeAttribute("data-ive-rightclick"),e.removeAttribute("data-ive-menu"),function(e,t){var i={};i.customConfig="".concat(window.RConstants.staticPath,"/dist/assets/ckeditor/config--ive.js"),i.height=t.blatherHeight?"".concat(t.blatherHeight,"px"):"50px","OPEN"===t.editType&&(i.customConfig="".concat(window.RConstants.staticPath,"/dist/assets/ckeditor/config--blank.js"),i.on={instanceReady:function(e){document.getElementById("".concat(e.editor.id,"_top")).style.display="none"}}),window.CKEDITOR.replace("ive__blatherEdit--".concat(t.nodeId),i).on("change",function(e){clearTimeout(o);var i=e.editor.getData();o=a(function(){r(i,t)},500)})}(0,t),i.bindEvents()})},d=function(e,t){if(!t.nodeId)return RUtils.console.warn("IVE","No node ID found, skipping."),!1;"BLOG"===R[t.listId].formatType&&(t.blatherHeight=e.offsetHeight>50?e.offsetHeight:270),function(e){var t=RUtils.spinner.create("ive__loadBlather");n(function(){e.innerHTML=t})}(e),RUtils.ajax({url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items/").concat(t.nodeId),callback:function(i){!function(e,t,i){var a='<textarea id="ive__blatherEdit--'.concat(t.nodeId,'" class="ive__blatherEdit block">').concat(i.blather?i.blather:"","</textarea>")+'<button class="ive__blatherEditComplete block white rnkrDBlueBg $ive" data-ive-click="node:blatherEdit:update" '+'data-ive-options="'.concat(t.parseObjectAsQueryString(),'" ')+'>all done <svg class="ive__blatherEditCompleteIcon rsvg relative"><use xlink:href="#rsvg__ive--check" href="#rsvg__ive--check"/></svg></button>';c(e,t,a)}(e,t,i)}})},l=function(e,t,i){if(""===i.trim()&&(i="Add commentary (optional)","VIDEO"===R[t.listId].listViewFormatType&&(i="Describe your item")),"GRID"===R[t.listId].listViewFormatType&&!R[t.listId].listOptions.bigGrid){var a=i.stripHTML();i=a.length>230?a.substring(0,230):a}var o="node:blatherEdit:title|node:blatherEdit:action,node:blatherDelete:title|node:blatherDelete:action";"VIDEO"===R[t.listId].listViewFormatType&&(o="node:blatherEdit:title|node:blatherEdit:action,node:del:title|node:del:action"),"BLOG"===R[t.listId].listViewFormatType&&R[t.listId].listOptions.showImages&&(o+=",node:showImage:".concat(t.showImage.parseBoolean()?"altTitle":"title","|node:showImage:action"),e.setAttribute("data-ive-options","listId=".concat(t.listId,"&nodeId=").concat(t.nodeId,"&showImage=").concat(t.showImages))),document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"] .listItem__properties')),n(function(){e.innerHTML=i,e.classList.add("$ive"),e.setAttribute("data-ive-click","node:blatherEdit:click"),e.setAttribute("data-ive-rightclick","ive:menu:create"),e.setAttribute("data-ive-menu",o)})},i.nodeBlatherEdit=function(e){var t=s(e),i=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__blather")[0];d(i,t),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeBlatherEdit")})},i.nodeBlatherClick=function(e){var t=s(e);d(e,t),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeBlatherClick")})},i.nodeBlatherUpdate=function(e){var t=s(e),i="ive__blatherEdit--".concat(t.nodeId),a=CKEDITOR.instances[i].getData();l(e.parentNode,t,a),CKEDITOR.instances[i].destroy(),RView.IVE.menuDestroy(),RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodeBlatherUpdate")})},i.nodeBlatherDelete=function(e){var t=s(e),i=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__blather")[0];r("",t),l(i,t,""),RView.IVE.menuDestroy()},i)},303:function(e,t){var i,a,n,o,s,r,c,d,l,u,m,p,v;window.RView.IVE=(i=window.RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=!1,s=[],r=!1,c=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).editType=(t.editType||"EDIT").toUpperCase(),t},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ENABLE",t=document.querySelector('.modal__close[data-modal-id="propertyEdit"]');t&&n("DISABLE"===e?function(){t.classList.add("-disabled"),t.setAttribute("data-modal-disabled","true")}:function(){t.classList.remove("-disabled"),t.removeAttribute("data-modal-disabled")})},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ENABLE",t=document.querySelector('.modal__success[data-modal-id="propertyEdit"]');t&&n("DISABLE"===e?function(){t.classList.add("-disabled"),t.setAttribute("data-modal-disabled","true")}:function(){t.classList.remove("-disabled"),t.removeAttribute("data-modal-disabled")})},u=function(e,t,i){for(var a,o=document.createDocumentFragment(),s=0;a=i.node.nodeProperties[s];s++)if(a.showable){var r=i.node.nodeProperty.propertyId===a.propertyId,c=document.createElement("label");c.className="ive__propertyEditLabel block",c.for="ive__propertyEditLabel block".concat(a.propertyName),c.textContent="".concat(a.displayName).concat(r?" (default)":"");var d=document.createElement("input");d.type="text",d.id="ive__propertyEdit--".concat(a.propertyName),d.className="ive__propertyEditInput ive__formInput relative block $ive",d.value="".concat(void 0!==a.propertyValue?a.propertyValue:""),d.setAttribute("data-property-id",a.propertyId),d.setAttribute("data-ive-keyuprealtime","node:propertyEdit:disable"),d.setAttribute("data-ive-keyup","node:propertyEdit:save"),d.setAttribute("data-ive-paste","node:propertyEdit:save"),d.setAttribute("data-ive-options","".concat(t.parseObjectAsQueryString(),"&isDefault=").concat(r)),o.appendChild(c),o.appendChild(d)}var l,u,m=document.createElement("span");m.id="ive__propertyConfirm",m.className="relative block center",o.appendChild(m),l=o,u=document.getElementById("modal__propertyEdit").getElementsByClassName("modal__content")[0],window.RUtils.spinner.destroy("modalLoad"),n(function(){u.appendChild(l)})},m=function(e,t,a){return t.nodeId?(window.RUtils.ajax({url:"".concat(window.RConstants.apiPath,"/lists/").concat(t.listId,"/items/\n              ").concat(t.nodeId,"?propertyFetchType=ALL"),callback:function(s){a?function(e,t,a){if(o){var s=window.R[t.listId].listViewFormatType,r=a.node.nodeProperty.propertyValue.trim();switch(""===r&&(r="add info (optional)"),s){case"BLOG":i.blogProperties(e,t,a);break;default:n(function(){e.innerHTML=r.trimProperties(2)})}}}(e,t,s):u(0,t,s)}}),!0):(window.RUtils.console.warn("IVE","No node ID found, skipping."),!1)},p=function(e,t){window.RUtils.modal.create({id:"propertyEdit",width:"400px",height:"450px",title:"Add Info",successButton:"update",closeOnClick:!1,closeOnEscape:!1,showSpinner:!0,onOpen:function(){m(e,t)},onSuccess:function(){if(!document.querySelector('.modal__success[data-modal-id="propertyEdit"]').getAttribute("data-modal-disabled")){var i=0;r&&(i=3e3),a(function(){m(e,t,!0)},i)}}})},v=function(e,t,a,n){t.isDefault&&(o=!0),window.RUtils.ajax({headers:{Accept:"application/json","Content-Type":"application/json","access-token":window.RUtils.cookie.get("RT")},method:a.method,url:"".concat(window.RConstants.apiPath,"/nodeedits/").concat(t.listId,"/nodes/").concat(t.nodeId,"\n              /edit/").concat("PATCH"===a.method?a.id:""),data:JSON.stringify({classId:window.RList.classId,listId:t.listId,ontologyId:t.nodeId,valueId:t.nodeId,classPropertyId:a.id,value:a.value,editDate:Date.now(),editType:"EDIT_MODIFY"}),error:function(t){window.RUtils.console.error("IVE","Property saving error",t),e.classList.add("ive__propertyEditInput--error"),alert("There was an error saving your property (".concat(a.id,"). Please try again."))},callback:function(){var a;e.classList.add("ive__propertyEditInput--complete"),document.getElementById("ive__propertyConfirm").textContent="Saved",a=n,s.splice(a,1),0===s.length&&(r=!1,l(),d()),i.flushListCache(t)}})},i.nodePropertyEdit=function(e){var t=c(e),i=document.querySelector('.listItem[data-node-id="'.concat(t.nodeId,'"]')).getElementsByClassName("listItem__properties")[0];p(i,t),window.RView.IVE.menuDestroy(),window.RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodePropertyEdit")})},i.nodePropertyClick=function(e){var t=c(e);p(e,t),window.RView.IVE.menuDestroy(),window.RUtils.trackEvent({category:"list",action:"".concat(t.editType,"_nodePropertyClick")})},i.nodePropertyDisable=function(){r||(r=!0,l("DISABLE"),d("DISABLE"),n(function(){document.getElementById("ive__propertyConfirm").innerHTML=""}))},i.nodePropertySave=function(e){var t=s.push({elem:e,options:c(e)});(function(e){var t=s[e],i={id:t.elem.getAttribute("data-property-id"),value:t.elem.value};t.elem.classList.remove("ive__propertyEditInput--error"),t.elem.classList.remove("ive__propertyEditInput--complete"),window.RUtils.ajax({method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","access-token":window.RUtils.cookie.get("RT")},url:"".concat(window.RConstants.apiPath,"/nodeedits/").concat(t.options.listId,"\n              /nodes/").concat(t.options.nodeId,"/edit/").concat(i.id),error:function(){i.method="POST",v(t.elem,t.options,i,e)},callback:function(){i.method="PATCH",v(t.elem,t.options,i,e)}})})(t-=1),window.RUtils.trackEvent({category:"list",action:"".concat(s[t].options.editType,"_nodePropertySave")})},i)},304:function(e,t){var i,a,n,o,s,r,c,d,l,u,m,p;RView.IVE=(i=RView.IVE,s=window.clearTimeout,r=window.setTimeout,c=window.requestAnimationFrame||r,d=!1,l=function(e){c(function(){var t=window.scrollY||window.pageYOffset,i=e.getBoundingClientRect();a.style.top="".concat(i.top+t-"10","px"),a.style.left="".concat(i.left+i.width,"px")})},u=function(e){var t=document.getElementsByClassName("ive__create"),i="";t.length&&(i=t[0].getAttribute("data-list-classes")),(a=document.createElement("div")).className="ive__searchWiki float absolute whiteBg".concat(i),function(e){c(function(){document.body.appendChild(a),l(e)})}(e)},m=function(){c(function(){a&&(a.style.display="none",a.innerHTML="")})},p=function(e,t){RUtils.ajax({url:"".concat(RConstants.cachedApiPath,"/nodes/").concat(t,"/wiki"),callback:function(e){var t;void 0!==e.wikiText&&null!==e.wikiText&&e.wikiText.length?(e.wikiText.length>560&&(e.wikiText="".concat(e.wikiText.substr(0,560),"...")),t=e.wikiText,c(function(){a.innerHTML=t})):m()}})},i.nodeSearchShowWiki=function(e){var t=e.getAttribute("data-node-id");if(!t||""===t||"undefined"===t||t===o)return!1;o=t,s(n),d?function(e){c(function(){a.style.display="block",e&&l(e),a.innerHTML=RUtils.spinner.create("iveSearchWiki")})}(e):(u(e),d=!0),p(0,t)},i.nodeSearchHideWiki=function(e){s(n),n=r(function(){m(),o=null},(e=e||!1)?0:1e3)},i)},305:function(e,t){var i,a,n,o,s,r,c,d,l,u,m,p,v,g,y,f,I,h,_,E;RView.IVE=(i=RView.IVE,r=window.setTimeout,c=window.requestAnimationFrame||r,d=!1,l=!1,u=function(e){e=e||"252px";var t=document.getElementsByClassName("ive__searchResults");t.length&&c(function(){t[0].style.maxHeight=e})},m=function(e){c(function(){n.appendChild(e)})},p=function(e,t,a,n){var o="node:search:addItem";n&&n.addItem&&(o=n.addItem);var s,r="";e.imgixUrl||(e.imgixUrl="".concat(RConstants.staticPath,"/dist/img/app/ranker_noimage--small.svg"),r=" ive__searchResultImg--noImage"),"OPEN"===n.searchType&&!i.isAdmin()&&t&&a&&(s=document.getElementsByClassName("ive__searchAuthored")).length&&c(function(){s[0].style.display="none",u("312px")});var d,l="ive__searchResultItem relative flex $ive",p='<img src="'.concat(e.imgixUrl,'?w=46&h=46&q=60&fm=pjpg&fit=crop&crop=faces" class="ive__searchResultImg').concat(r,'"/>')+'<span class="ive__searchResultTitle flex">';if(t&&!a&&(p+='<span class="ive__searchResultInfo rnkrCRRed block">exact match</span>'),a&&(p+='<span class="ive__searchResultInfo rnkrCRRed block">already on the list</span>',l+=" ive__searchResultItem--isOnList"),p+=e.name,e.defaultProperty&&e.defaultProperty.id&&parseInt(R[n.listId].listOptions.defaultPropertyId,10)===e.defaultProperty.id){var v=e.defaultProperty.values[0].split(/,/);v.splice(2);var g=v.join();p+='<span class="ive__searchResultData block">'.concat(g.replace(/\^!/g,","),"</span>")}p+="</span>",p+=a?(d=a,"".concat('<span class="ive__searchResultAt center block absolute"><svg class="ive__searchResultAtIcon block left"><use xlink:href="#rsvg__ive--check" href="#rsvg__ive--check"/></svg>at #').concat(d.addCommas(),"</span>")):"".concat('<button class="ive__searchResultAdd button button--rounded rnkrBlue block absolute pointer $ive" data-node-id="').concat(e.id,'" ')+'data-ive-options="'.concat(n.parseObjectAsQueryString(),'" ')+'data-ive-click="'.concat(o,'" ')+">+ add</button>";var y=document.createElement("div");y.className=l,y.setAttribute("data-node-id",e.id),y.setAttribute("data-node-name",e.name),y.setAttribute("data-ive-mouseenter","node:search:showWiki"),y.innerHTML=p,m(y)},v=function(e,t){var i={};i.name=e.replace(/"/g,"&quot;"),i.imgixUrl="".concat(RConstants.staticPath,"/dist/img/app/ranker_noimage--small.svg");var a="node:search:createItem";t&&t.createItem&&(a=t.createItem);var n='<img src="'.concat(i.imgixUrl,'" class="ive__searchResultImg ive__searchResultImg--noImage"/>')+'<span class="ive__searchResultTitle flex">'+'<span class="ive__searchResultInfo rnkrCRRed block">don\'t see it? create it</span>'.concat(i.name,"</span>")+'<button class="ive__searchResultCreate button button--rounded black block absolute pointer $ive" '+'data-ive-options="'.concat(t.parseObjectAsQueryString(),'" ')+'data-create-name="'.concat(i.name,'" ')+'data-ive-click="'.concat(a,'">create</button>'),s=document.createElement("div");s.className="ive__searchResultItem relative flex",s.innerHTML=n,function(e){c(function(){o.style.display="block",o.appendChild(e),u()})}(s)},g=function(e,t,i,o){e=e.toLowerCase();var s,r,d=function(e){for(var t,a=0;t=i[a];a++)if(t.node.id===e)return t.rank;return!1};n.innerHTML="";for(var l,u=0;l=t[u];u++)p(l,(s=l.name,e===s.toLowerCase()),d(l.id),o);if(0===t.length&&((r=document.createElement("div")).className="ive__searchNoResults relative center width100",r.innerHTML='<strong class="ive__searchNoResultsTitle block rnkrBlue robotoC">That\'s Not In Our System</strong><span class="ive__searchNoResultsMessage block black robotoL">but you can add it anyway by clicking \'create\'</span>',m(r)),t.length>4){var v=a.getElementsByClassName("ive__searchResultCreate");if(!v.length)return;c(function(){v[0].classList.add("ive__searchResultCreate--adjust")})}},y=function(e){c(function(){var t=e.getBoundingClientRect(),i=a.getBoundingClientRect();t.top-(i.height+2)<0?a.style.top="".concat(t.bottom+RConstants.windowScrollTop-2,"px"):a.style.top="".concat(t.top+RConstants.windowScrollTop-(i.height+0),"px"),a.style.left="".concat(t.left,"px")})},f=function(e){if(d)return!1;d=!0;var t=document.createElement("span");t.className="ive__searchClose absolute block pointer $ive",t.setAttribute("data-ive-click","node:search:close"),c(function(){var i=window.scrollY||window.pageYOffset,a=e.getBoundingClientRect();t.style.top="".concat(a.top+i+10,"px"),t.style.left="".concat(a.left+a.width-26,"px"),document.body.appendChild(t),t.innerHTML='<svg class="ive__searchCloseIcon rsvg"><use xlink:href="#rsvg__ui--close" href="#rsvg__ui--close"></use></svg>'})},I=function(e,t){(a=document.createElement("div")).className="ive__search float absolute",(n=document.createElement("div")).className="ive__searchResults relative $ive",n.innerHTML=RUtils.spinner.create("iveSearch"),n.setAttribute("data-ive-mouseleave","node:search:hideWiki"),n.setAttribute("data-ive-options",t.parseObjectAsQueryString()),a.style.display="block",a.appendChild(n),(o=document.createElement("div")).className="ive__searchAuthored absolute width100",o.innerHTML="",a.appendChild(o),function(e){c(function(){document.body.appendChild(a),y(e)})}(e),f(e)},h=function(){c(function(){s&&void 0!==s.value&&(s.value="",s.focus());var e=document.getElementsByClassName("ive__searchClose");if(e.length){for(var t,i=0;t=e[i];i++)t.removeEventListener("click",null,!1),t.remove();d=!1}})},_=function(e){c(function(){e&&y(e),a.style.display="block",n.innerHTML=RUtils.spinner.create("iveSearch"),o.innerHTML="",i.nodeSearchHideWiki(!0)}),f(e)},E=function(){c(function(){a&&(a.style.display="none"),h(),i.nodeSearchHideWiki(!0),u()})},i.nodeSearch=function(e,t){var a,n=e.getAttribute("data-ive-options");(n=n&&""!==n&&"undefined"!==n?n.parseQueryString():{}).searchType=(n.searchType||"EDIT").toUpperCase(),a=e.value,!i.isAdmin()||a.match(/\s/)||isNaN(parseInt(a))?(l?_(e):(I(e,n),l=!0),c(function(){!function(e,t){if(""===e.value.trim())return E(),!1;var i={term:e.value.trim().replace(/'/g,"'").replace(/"/g,"'"),listId:t.listId||"",classId:t.classId||"",defaultPropertyId:R[t.listId].listOptions.defaultPropertyId,offset:0,resultLength:25};RView.IVE.isAdmin()&&(i.isAdmin=!0),RUtils.ajax({url:"".concat(RConstants.cachedApiPath,"/search/nodes"),data:i,callback:function(i){if(t.listId){for(var a,n=[],o=0;a=i.primaryResponse.results[o];o++)n.push(a.id);RUtils.ajax({url:"".concat(RConstants.apiPath,"/lists/").concat(t.listId,"/items?nodeIds=").concat(n.toString()),callback:function(a){g(e.value,i.primaryResponse.results,a.listItems,t)}})}else g(e.value,i.primaryResponse.results,[],t);v(e.value,t)}}),RUtils.trackEvent({category:"list",action:"".concat(t.searchType,"_search")})}(e,n)})):13===t.which&&i.addNodeById(e,n),s=e,RUser.data.setProperty("hasOpenItems",!0)},i.nodeSearchClearLastInput=function(){h()},i.nodeSearchResetContainer=function(e){_(e)},i.nodeSearchHideContainer=function(){E()},i)},306:function(e,t){var i,a,n,o,s,r;RView.IVE=(i=RView.IVE,a=window.setTimeout,n=window.requestAnimationFrame||a,o=function(e){var t=e.getAttribute("data-ive-options");return(t=t&&""!==t&&"undefined"!==t?t.parseQueryString():{}).searchType=(t.searchType||"EDIT").toUpperCase(),t},s=function(e,t){if("VIDEO"!==RList.listViewFormatType&&(i.nodeSearchResetContainer(),i.nodeSearchHideContainer(),i.nodeSearchClearLastInput()),"GRID"!==RList.listViewFormatType&&"BLOG"!==RList.listViewFormatType&&"VIDEO"!==RList.listViewFormatType)return!1;switch(e.listItems[0].listId||(e.listItems[0].listId=t.listId),t.searchType){case"OPEN":var o=document.getElementById("list");if(!o)return;RView.openListItemAdded.push(e.listItems[0].node.id),n(function(){o.appendChild(RView.displayGridListItems(e).items),n(function(){RUtils.postMessage.emit("LOADMORE_COMPLETE")})});break;case"EDIT":switch(RList.listViewFormatType){case"GRID":i.displayGridListItems(e);break;case"BLOG":i.displayBlogListItems(e);break;case"VIDEO":i.displayVideoListItems(e)}a(function(){i.coach("addItem",document.querySelector('.listItem[data-node-id="'.concat(e.listItems[0].node.id,'"] .listItem__title')))},2e3)}var s,r;(s=document.getElementsByClassName("list__dataItem--totalItems")[0])&&(s.textContent="".concat(RList.listStats.totalItems," items")),(r=document.getElementsByClassName("ive__create")[0])&&(r=r.getElementsByClassName("listItem__rank")[0]),r&&n(function(){r.textContent=RList.listStats.totalItems+1}),function(){var e=document.getElementById("ive__barNodeCount");e&&(e.textContent=RList.listStats.totalItems)}()},r=function(e,t,i){var a={node:e,userId:RUser.profile.getProperty("id"),showUser:!1};"OPEN"===i.searchType&&(a.showUser=!0),RUtils.ajax({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/lists/").concat(RList.id,"/items/").concat(e.id),data:JSON.stringify(a),error:function(e){RUtils.console.error("IVE","Error adding to list",e);var t=JSON.parse(e.response);t.message&&alert(t.message)},callback:function(){!function(e,t){var i={listItems:[]};RUtils.ajax({url:"".concat(RConstants.apiPath,"/lists/").concat(RList.id,"/items/").concat(e,"?include=wikiText,rankings,openListItemContributors&propertyFetchType=ALL"),callback:function(e){var a={rank:e.rank,name:e.name,node:e.node,mediaType:e.mediaType,votes:{score:0,upVotes:0,downVotes:0},lockedPosition:0};e.image&&(a.image=e.image),e.video&&(a.video=e.video),e.openListItemContributor&&(a.openListItemContributor=e.openListItemContributor),i.listItems.push(a),s(i,t)}})}(e.id,i)}}),RUtils.trackEvent({category:"list",action:"".concat(i.searchType,"_add_system")})},i.addNodeById=function(e,t){if(t){var i={id:parseInt(e.value)};r(i,0,t)}},i.nodeSearchAddItem=function(e){var t=e.getAttribute("data-node-id");if(!t)return!1;var a={id:t};if("LIST"===RConstants.pageType&&i.isGuest())return RUser.createSignIn("auto"),RUtils.postMessage.handle("USER_SIGNED_IN",function(){i.nodeSearchAddItem(e)}),!1;var n=o(e);e.outerHTML=RUtils.spinner.create("iveSearchAdd-".concat(a.id),{position:"absolute",classes:"ive__searchResultAdding"}),++RList.listStats.totalItems,r(a,0,n)},i.nodeSearchCreateItem=function(e){var t=o(e);if(!t.listId)return!1;var a=e.getAttribute("data-create-name");return!!a&&("LIST"===RConstants.pageType&&i.isGuest()?(RUser.createSignIn("auto"),RUtils.postMessage.handle("USER_SIGNED_IN",function(){i.nodeSearchCreateItem(e)}),!1):("VIDEO"!==RList.listViewFormatType&&(e.outerHTML=RUtils.spinner.create("iveSearchCreate",{position:"absolute",classes:"ive__searchResultAdding"})),++RList.listStats.totalItems,RUtils.ajax({method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","access-token":RUtils.cookie.get("RT")},url:"".concat(RConstants.apiPath,"/nodeedits"),data:JSON.stringify({authoredNode:!0,name:a,listId:t.listId,classId:t.classId,userId:RUser.profile.getProperty("id")}),callback:function(e){r({id:e.id,name:a},0,t)}}),void RUtils.trackEvent({category:"list",action:"".concat(t.searchType,"_add_authored")})))},i)},307:function(e,t){var i;RView.IVE=((i=RView.IVE).addConfig("node",{del:{title:"delete item",action:i.nodeDelete},imageEdit:{title:"add/edit image",action:i.nodeImageEdit,previewFile:i.nodeImagePreviewFromFile,previewURL:i.nodeImagePreviewFromURL,previewGallery:i.imagePreviewFromGallery,previewDestroy:i.imagePreviewDestroy,previewSetAspectRatio:i.imagePreviewSetAspectRatio,previewCropImage:i.imagePreviewCropImage,addImage:i.nodeImageAdd,gallerySearch:i.imageGallerySearch,gallerySearchByKey:i.imageGallerySearchByKey,galleryTab:i.imageGalleryTab,attributionEdit:i.imageAttributionEdit,attributionSave:i.imageAttributionSave,attributionDestroy:i.imageAttributionDestroy},imageDelete:{title:"delete image",action:i.nodeImageDelete},videoEdit:{title:"add/edit video",action:i.nodeVideoEdit,previewGallery:i.videoPreviewFromGallery,previewDestroy:i.videoPreviewDestroy,previewComplete:i.videoPreviewComplete,addVideo:i.nodeVideoAdd,gallerySearch:i.videoGallerySearch,gallerySearchByKey:i.videoGallerySearchByKey,galleryTab:i.videoGalleryTab},videoDelete:{title:"delete video",action:i.nodeVideoDelete},mediaDelete:{title:"delete",action:i.nodeMediaDelete},nameEdit:{title:"edit item name",action:i.nodeNameEdit,click:i.nodeNameClick,save:i.nodeNameSave,update:i.nodeNameUpdate},propertyEdit:{title:"add/edit info",action:i.nodePropertyEdit,click:i.nodePropertyClick,save:i.nodePropertySave,disable:i.nodePropertyDisable},blatherEdit:{title:"add/edit commentary",action:i.nodeBlatherEdit,click:i.nodeBlatherClick,update:i.nodeBlatherUpdate},blatherDelete:{title:"delete commentary",action:i.nodeBlatherDelete},linkEdit:{title:"add/edit ext. URL",action:i.nodeLinkEdit},search:{title:"Search",action:i.nodeSearch,close:i.nodeSearchHideContainer,showWiki:i.nodeSearchShowWiki,hideWiki:i.nodeSearchHideWiki,addItem:i.nodeSearchAddItem,createItem:i.nodeSearchCreateItem},showImage:{title:"display item image",altTitle:"hide item image",action:i.nodeShowImage}}),i)}});